<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        <meta name="author" content="Jun Zhang">
        <link rel="canonical" href="http://jupedsim.github.io/jpsreport/contributing/">
        <link rel="shortcut icon" href="../favicon.icon">
        

	<title>Contributing - JuPedSim/jpsreport</title>

        <link href="../css/bootstrap-3.0.3.min.css" rel="stylesheet">
        <link href="../css/font-awesome-4.0.3.css" rel="stylesheet">
        <link rel="stylesheet" href="../css/highlight.css">
        <link href="../css/base.css" rel="stylesheet">

        <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
        <!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
            <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->

        
    </head>

    <body>

        <div class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">

        <!-- Collapsed navigation -->
        <div class="navbar-header">
            <!-- Expander button -->
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>

            <!-- Main title -->
            <a class="navbar-brand" href="..">JuPedSim/jpsreport</a>
        </div>

        <!-- Expanded navigation -->
        <div class="navbar-collapse collapse">
            <!-- Main navigation -->
            <ul class="nav navbar-nav">
            
            
                <li >
                    <a href="..">Home</a>
                </li>
            
            
            
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">User guide <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    
                        <li >
                            <a href="../user_guide/quickstart/">Quickstart</a>
                        </li>
                    
                        <li >
                            <a href="../user_guide/requirements/">Requirements</a>
                        </li>
                    
                        <li >
                            <a href="../user_guide/configuration/">Configuration</a>
                        </li>
                    
                        <li >
                            <a href="../about/disclaimer/">Disclaimer</a>
                        </li>
                    
                        <li >
                            <a href="../about/LICENSE/">License</a>
                        </li>
                    
                    </ul>
                </li>
            
            
            
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">Input Files <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    
                        <li >
                            <a href="../inputs/geometry/">Geometry File</a>
                        </li>
                    
                        <li >
                            <a href="../inputs/trajectory/">Trajectory File</a>
                        </li>
                    
                        <li >
                            <a href="../inputs/inifile/">Configuration File</a>
                        </li>
                    
                    </ul>
                </li>
            
            
            
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">Methods and Output <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    
                        <li >
                            <a href="../methods/method_A/">Method A</a>
                        </li>
                    
                        <li >
                            <a href="../methods/method_B/">Method B</a>
                        </li>
                    
                        <li >
                            <a href="../methods/method_C/">Method C</a>
                        </li>
                    
                        <li >
                            <a href="../methods/method_D/">Method D</a>
                        </li>
                    
                    </ul>
                </li>
            
            
            
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">Sample cases <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    
                        <li >
                            <a href="../samples/get_fundamental_diagram/">How to get fundamental diagram</a>
                        </li>
                    
                        <li >
                            <a href="../samples/get_profile/">How to get profiles</a>
                        </li>
                    
                    </ul>
                </li>
            
            
            
                <li class="active">
                    <a href="./">Contributing</a>
                </li>
            
            
            </ul>

            <!-- Search, Navigation and Repo links -->
            <ul class="nav navbar-nav navbar-right">
                <li >
                    <a rel="next" href="../samples/get_profile/">
                        <i class="fa fa-arrow-left"></i> Previous
                    </a>
                </li>
                <li class="disabled">
                    <a rel="prev" >
                        Next <i class="fa fa-arrow-right"></i>
                    </a>
                </li>
                
                <li>
                    <a href="https://github.com/JuPedSim/jpsreport">
                        
                            <i class="fa fa-github"></i>
                        
                        GitHub
                    </a>
                </li>
                
            </ul>
        </div>
    </div>
</div>

        <div class="container">
            <div class="col-md-3"><div class="bs-sidebar hidden-print affix well" role="complementary">
    <ul class="nav bs-sidenav">
    
        <li class="main active"><a href="#contributing-to-jupedsim">Contributing to JuPedSim</a></li>
        
            <li><a href="#new-contributors">New contributors</a></li>
        
            <li><a href="#reporting-bugs-and-requesting-features">Reporting bugs and requesting features</a></li>
        
            <li><a href="#writing-code">Writing Code</a></li>
        
            <li><a href="#writing-a-unit-test">Writing a unit test</a></li>
        
            <li><a href="#writing-documentation">Writing Documentation</a></li>
        
            <li><a href="#commiting-code">Commiting Code</a></li>
        
    
    </ul>
</div></div>
            <div class="col-md-9" role="main">

<h1 id="contributing-to-jupedsim"><a class="toclink" href="#contributing-to-jupedsim">Contributing to JuPedSim</a></h1>
<p>This project is mainly developed by a small group of researchers and students from <a href="http://www.fz-juelich.de/en">JÃ¼lich Research Center</a> and <a href="http://www.uni-wuppertal.de/">BUW</a>.
However you are kindly invited not only to use JuPedSim but also contributing to our open-source-project.
It does not matter if you are a researcher, student or just interested in pedestrian dynamics.
There are only a few rules and advices we want to give to you:</p>
<h2 id="new-contributors"><a class="toclink" href="#new-contributors">New contributors</a></h2>
<h3 id="first-steps"><a class="toclink" href="#first-steps">First steps</a></h3>
<ul>
<li>Clone/fork our github/gitlab repository</li>
</ul>
<pre><code>git clone https://cst.version.fz-juelich.de/jupedsim/jpscore.git
</code></pre>

<ul>
<li>Change to the developement branch and create a branch with your feature.</li>
</ul>
<pre><code>git checkout developement 
git checkout -b feature_name
</code></pre>

<ul>
<li>Assuming you are in the jpscore folder type </li>
</ul>
<pre><code>mkdir build &amp;&amp; cd build 
cmake .. 
</code></pre>

<ul>
<li>
<p>Download all dependencies, check if cmake tells you something is missing</p>
<ul>
<li>Boost &gt;= 1.56</li>
<li>Qt</li>
<li>Vtk</li>
</ul>
</li>
<li>
<p>If everything compiled for the first time, you are free to start</p>
</li>
</ul>
<h3 id="workflow"><a class="toclink" href="#workflow">Workflow</a></h3>
<p>The branches <strong>master</strong> and <strong>develop</strong> are <strong>protected</strong>. You can <strong>only push to your feature-branch.</strong>
Whenever you want to add a feature or fix an issue create a new feature-branch and only work on this branch.
If you change what you wanted to merge the develop-branch into your feature-branch.
Make sure all tests are running after merging and you provided new tests for your feature.
After doing that open a merge/pull request.</p>
<p>If your fix/feature is accepted it will be merged into the develop-branch.</p>
<h2 id="reporting-bugs-and-requesting-features"><a class="toclink" href="#reporting-bugs-and-requesting-features">Reporting bugs and requesting features</a></h2>
<p>If you got a question or a problem and need support from our team feel free to contact us.
You can do this via <a href="mailto:dev@jupedsim.org">email</a>.</p>
<p>If you think you found an issue or bug in JuPedSim please use our issue tracker.</p>
<h3 id="using-the-issue-tracker"><a class="toclink" href="#using-the-issue-tracker">Using the issue tracker</a></h3>
<p>The <a href="https://cst.version.fz-juelich.de/jupedsim/jpsreport/issues">issue tracker</a> is the preferred channel for bug reports, features requests and submitting pull requests, but please respect the following restrictions:</p>
<ul>
<li>
<p>Please do not use the issue tracker for personal support requests. <a href="mailto:dev@jupedsim.org">Mail us</a> if you need personal support.</p>
</li>
<li>
<p>Please do not derail or troll issues. Keep the discussion on topic and respect the opinions of others.</p>
</li>
</ul>
<p>If you use the issue tracker we have a list of labels you should use.</p>
<h3 id="reporting-bugs"><a class="toclink" href="#reporting-bugs">Reporting bugs</a></h3>
<p>If you find a bug in the source code or a mistake in the documentation, you can help us by submitting an issue to our repository.
Even better you can submit a pull or merge request with a fix. Please use the following template and make sure you provide us as much information as possible:</p>
<pre><code class="md">[Short description of problem here]

**Reproduction Steps:**

1. [First Step]
2. [Second Step]
3. [Other Steps...]

**Expected behavior:**

[Describe expected behavior here]

**Observed behavior:**

[Describe observed behavior here]

**Screenshots and GIFs**

![Screenshots and GIFs which follow reproduction steps to demonstrate the problem](url)

**JuPedSim version:** [Enter JuPedSim version here]
**OS and version:** [Enter OS name and version here]
**Compiler and version:** [Enter compiler name and version here]

**Installed Libraries:**
[Enter Boost version here]
[Enter Vtk version here]
[Enter Qt version here]

**Additional information:**

* Problem started happening recently, didn't happen in an older version of JuPedSim: [Yes/No]
* Problem can be reliably reproduced, doesn't happen randomly: [Yes/No]
* Problem happens with all files and projects, not only some files or projects: [Yes/No]
* Problem happens with the attached ini and geometry files: [Yes/No]
</code></pre>

<h3 id="requesting-features"><a class="toclink" href="#requesting-features">Requesting features</a></h3>
<p>Enhancement suggestions are tracked as issues. After you&rsquo;ve determined which repository your enhancement suggestions is related to, create an issue on that repository and provide the following information:</p>
<ul>
<li>Use a clear and descriptive title for the issue to identify the suggestion.</li>
<li>Provide a step-by-step description of the suggested enhancement in as many details as possible.</li>
<li>Provide specific examples to demonstrate the steps. Include copy/pasteable snippets which you use in those examples, as Markdown code blocks.</li>
<li>Describe the current behavior and explain which behavior you expected to see instead and why.</li>
</ul>
<p>If you want to support us by writing the enhancement yourself consider what kind of change it is:</p>
<ul>
<li><strong>Major changes</strong> that you wish to contribute to the project should be discussed first on our <strong>dev mailing list</strong> so that we can better coordinate our efforts, prevent duplication of work, and help you to craft the change so that it is successfully accepted into the project.</li>
<li><strong>Small changes</strong> can be crafted and submitted to our repository as a <strong>pull or merge request</strong>.</li>
</ul>
<p>Nevertheless open an issue for documentation purposes with the following template:</p>
<pre><code class="md">[Short description of suggestion]

**Steps which explain the enhancement**

1. [First Step]
2. [Second Step]
3. [Other Steps...]

**Current and suggested behavior**

[Describe current and suggested behavior here]

**Why would the enhancement be useful to most users**

[Explain why the enhancement would be useful to most users]

[List some other text editors or applications where this enhancement exists]

**Screenshots and GIFs**

![Screenshots and GIFs which demonstrate the steps or part of JuPedSim the enhancement suggestion is related to](url)

**JuPedSim Version:** [Enter JuPedSim version here]
**OS and Version:** [Enter OS name and version here]~

</code></pre>

<h2 id="writing-code"><a class="toclink" href="#writing-code">Writing Code</a></h2>
<h3 id="coding-style"><a class="toclink" href="#coding-style">Coding style</a></h3>
<p>In JuPedSim we try to code according to the <em>Stroustrup</em> style of formatting/indenting.
If you want (or have) to write code in JuPedSim you really <strong>need</strong> to respect that style.
This is important not just aesthetically but also practically. Diff commits are much more clearer and cleaner.</p>
<p>The code is formated using the automatic formatter <a href="http://astyle.sourceforge.net/astyle.html">astyle</a>  with the option <code>--style=stroustrup</code>:</p>
<blockquote>
<p>Stroustrup style formatting/indenting uses stroustrup brackets.
Brackets are broken from function definitions only.
Brackets are attached to everything else including
namespaces, classes, and statements within a function, arrays, structs, and enums.
This style frequently is used with an indent of 5 spaces.</p>
</blockquote>
<p>Here is an <strong>example:</strong></p>
<pre><code class="c++">int Foo(bool isBar)
{
     if (isBar) {
          bar();
          return 1;
     } else
          return 0;
}
</code></pre>

<h4 id="tabs-vs-spaces"><a class="toclink" href="#tabs-vs-spaces">Tabs vs Spaces</a></h4>
<p>This can be a long and religious discussion, to make it short <em>DO NOT</em> use tabs, just spaces please.</p>
<p>Here are some hints to configure your editor in order to use the <em>stroustrup</em> style</p>
<ul>
<li><strong>Emacs</strong>:
    Add this to your <code>.emacs</code></li>
</ul>
<pre><code class="lisp">(setq c-default-style &quot;stroustrup&quot; c-basic-offset 5)
(setq indent-tabs-mode nil)
</code></pre>

<ul>
<li><strong>Vim</strong>:
    Set in your config file these variables</li>
</ul>
<pre><code class="javascript">:set autoindent
:set cindent
:set expandtab
:set shiftwidth=5
:set softtabstop=5
</code></pre>

<ul>
<li>
<p><strong>Eclipse</strong>:
    Here is a <a href="http://astyleclipse.sourceforge.net/">plugin</a> for astyle in eclipse.
    Read also
    <a href="https://superuser.com/questions/462221/how-do-i-reliably-change-the-indentation-width-in-eclipse">How to change indentation width in eclipse?</a></p>
</li>
<li>
<p><strong>Clion</strong></p>
</li>
</ul>
<h3 id="unit-tests"><a class="toclink" href="#unit-tests">Unit tests</a></h3>
<p>Testing should be enabled by cmake as follows:</p>
<pre><code class="javascript">cmake -DBUILD_TESTING=ON ..
</code></pre>

<p>After compiling (<code>make</code>) the tests can be called as follows:</p>
<pre><code class="javascript">ctest
</code></pre>

<p>This will take some hours time (depending on your machine). Threfore, a quick testing could be used:</p>
<pre><code class="javascript">ctest -R Boost
</code></pre>

<p>which run a limited set of compiled unit tests on the code.</p>
<h2 id="writing-a-unit-test"><a class="toclink" href="#writing-a-unit-test">Writing a unit test</a></h2>
<p>If you write a unit test the first lines in your file should be</p>
<pre><code class="c++">#define BOOST_TEST_MODULE MyTest
#define BOOST_TEST_DYN_LINK
#include &lt;boost/test/unit_test.hpp&gt;
#include classtotest.h

BOOST_AUTO_TEST_SUITE(MyTestClass)
</code></pre>

<p>Then you can start implementing your test cases by using</p>
<pre><code class="c++">BOOST_AUTO_TEST_CASE(MyTestCase) 
{
  ...
}
</code></pre>

<p>For each method or function you want to test you should write a new test case and give it a speaking name.</p>
<h3 id="verification-and-validation"><a class="toclink" href="#verification-and-validation">Verification and validation</a></h3>
<p>Besides unit testing, we use in JuPedSim python-driven tests for verification and validation purposes.
Several validation and verification tests for <em>JuPedSim</em> (jpscore) are defined in the following section (e.g. Rimea and NIST).
In order to make the nightly builds run automatically, consider the following steps, before adding new tests.
This procedure is also recommended to make simulations with several inifiles e.g. different seeds.</p>
<p>To write additional tests, create a directory under <em>Utest/</em>.</p>
<ul>
<li>Create in <em>./jpscore/Utest/</em> a new direct with a descriptive name. For
   example: <em>/Utest/test_case1/</em></li>
<li>Put in that directory an ini-file (referred to as &ldquo;master-inifile&rdquo;)
   and all the relevant files for a simulation, e.g. geometry file, etc. In the master-inifile you can use python syntax</li>
</ul>
<p>Example:</p>
<pre><code class="xml">   &lt;max_sim_time&gt;[3,4]&lt;/max_sim_time&gt; 
   &lt;seed&gt;range(1, 10)&lt;/seed&gt;
</code></pre>

<ul>
<li>run the script <code>makeini.py</code> with the obligatory option <code>-f</code>: Using the
    aforementioned example the call is:</li>
</ul>
<pre><code class="bash">   python makeini.py -f test_case1/inifile.xml
</code></pre>

<p>The Script is going to create two directories:
- test_case/trajectories: Here live the simulation trajectories.
- test_case/inifiles: and here the inifiles, that will be produced  based on the master inifile (in this case test_case1/inifile.xml).
    Note, that the geometry file and the trajectory files are all relative to the project files in the directory <em>inifiles</em>.</p>
<ul>
<li>Write a runtest-script. Here you have to define the logic of your test. What should be tested? When does the file succeed or file? etc.</li>
</ul>
<p>Your script has to start with the following lines:</p>
<pre><code class="python">#!/usr/bin/env python
import os
import sys
from sys import *
sys.path.append(os.path.abspath(os.path.dirname(sys.path[0])))
from JPSRunTest import JPSRunTestDriver
from utils import *
</code></pre>

<p>After including these lines you can write the test you want to perform for every ini-file generated from the makeini.py script.
The method signature must contain at least two arguments to receive the inifile and the trajectory file from the simulation.</p>
<pre><code class="python">def runtest(inifile, trajfile):
</code></pre>

<p>You can also use more than these arguments like this:</p>
<pre><code class="python">def runtest(inifile, trajfile, x, y, z):
</code></pre>

<p>If you need a more complex example of how to use more arguments for further calculations please see runtest_14.py.
If a test has to fail because an error occurs or a necessary condition is not fulfilled  you can simply exit the script by using something like</p>
<pre><code class="python">if condition_fails: 
  exit(FAILURE)
</code></pre>

<p>Once you have written your test you have to make your script executable, so it has to contain a main function which calls the test:</p>
<pre><code class="python">if __name__ == &quot;__main__&quot;:
  test = JPSRunTestDriver(1, argv0=argv[0], testdir=sys.path[0])
  test.run_test(testfunction=runtest)
  logging.info(&quot;%s exits with SUCCESS&quot; % (argv[0]))
  exit(SUCCESS)
</code></pre>

<h2 id="writing-documentation"><a class="toclink" href="#writing-documentation">Writing Documentation</a></h2>
<h3 id="comments"><a class="toclink" href="#comments">Comments</a></h3>
<p>Comments have to be written in <strong>English</strong> everywhere. Please use markdown where applicable.</p>
<h3 id="documenting-new-features"><a class="toclink" href="#documenting-new-features">Documenting new features</a></h3>
<p>Please update the changelog with every feature/fix you provide so we can keep track of changes for new versions of JuPedSim.</p>
<h3 id="sample-templates"><a class="toclink" href="#sample-templates">Sample Templates</a></h3>
<pre><code>/*!
 * \file [filename]
 *
 * \author [your name]
 * \date
 * \version     v[x.y]
 * \copyright   &lt;2016-2022&gt; Forschungszentrum JÃ¼lich GmbH. All rights reserved.
 *
 * \section License
 * This file is part of JuPedSim.
 *
 * JuPedSim is free software: you can redistribute it and/or modify
 * it under the terms of the GNU Lesser General Public License as published by
 * the Free Software Foundation, either version 3 of the License, or
 * any later version.
 *
 * JuPedSim is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the
 * GNU General Public License for more details.
 *
 * You should have received a copy of the GNU Lesser General Public License
 * along with JuPedSim. If not, see &lt;http://www.gnu.org/licenses/&gt;.
 *
 * \section Description
 *
 * [your comment here]
 */
</code></pre>

<pre><code>/*!
 * \class [class name]
 *
 * \brief [brief description]
 *
 * [detailed description]
 *
 * \author [your name]
 * \date
 */
</code></pre>

<pre><code>/*!
 * \brief [brief description]
 *
 * [detailed description]
 *
 * \param[in] [name of input parameter] [its description]
 * \param[out] [name of output parameter] [its description]
 * \return [information about return value]
 * \sa [see also section]
 * \note [any note about the function you might have]
 * \warning [any warning if necessary]
 */
</code></pre>

<h2 id="commiting-code"><a class="toclink" href="#commiting-code">Commiting Code</a></h2>
<h3 id="commiting-guidelines"><a class="toclink" href="#commiting-guidelines">Commiting guidelines</a></h3>
<p>Please write clear and concise commit messages so that
your co-developers can directly grasp what changes on the code are you committing/pushing. Please do this with respect
to the following points:
- Name every class (file if you only change a single file) you changed and right after that a brief description of your
change.
- Use markdown if you want do make a longer description than two sentences.
- Reference issues and pull requests liberally if your commit is connected to one.
- When only changing documentation start with <code>:memo:</code>
- Consider starting the commit message with an applicable emoji:<br />
    - <img alt="img/new.png" src="../img/new.png" /> <code>:new:</code> when adding a new feature<br />
    - <img alt=":art:" src="../img/art.png" /> <code>:art:</code> when improving the format/structure of the code<br />
    - <img alt=":racehorse:" src="../img/racehorse.png" /> <code>:racehorse:</code> when improving performance<br />
    - <img alt=":memo:" src="../img/memo.png" /> <code>:memo:</code> when writing docs<br />
    - <img alt=":penguin:" src="../img/penguin.png" /> <code>:penguin:</code> when fixing something on Linux<br />
    - <img alt=":apple:" src="../img/apple.png" /> <code>:apple:</code> when fixing something on Mac OS<br />
    - <img alt=":checkered_flag:" src="../img/checkered_flag.png" /> <code>:checkered_flag:</code> when fixing something on Windows<br />
    - <img alt=":bug:" src="../img/bug.png" /> <code>:bug:</code> when fixing a bug<br />
    - <img alt=":fire:" src="../img/fire.png" /> <code>:fire:</code> when removing code or files<br />
    - <img alt=":green_heart:" src="../img/green_heart.png" /> <code>:green_heart:</code> when fixing the CI build<br />
    - <img alt=":white_check_mark:" src="../img/white_check_mark.png" /> <code>:white_check_mark:</code> when adding tests  </p></div>
        </div>

	<footer class="col-md-12">
		<hr>
		
		<p>Copyright &copy; 2016 <a href="http://www.fz-juelich.de">Forschungszentrum JÃ¼lich GmbH</a>. Maintenance by <a href="http://www.fz-juelich.de/SharedDocs/Personen/IAS/JSC/EN/staff/zhang_ju.html/">Jun Zhang</a>.</p>
		
		<p>Documentation built with <a href="http://www.mkdocs.org/">MkDocs</a>.</p>
	</footer>


        <script src="../js/jquery-1.10.2.min.js"></script>
        <script src="../js/bootstrap-3.0.3.min.js"></script>
        <script src="../js/highlight.pack.js"></script>
        <script src="../js/base.js"></script>
        <script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    </body>
</html>