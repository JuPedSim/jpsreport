<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        <meta name="author" content="Jun Zhang">
        <link rel="canonical" href="http://jupedsim.github.io/jpsreport/inputs/geometry/">
        <link rel="shortcut icon" href="../../favicon.icon">
        

	<title>Geometry File - JuPedSim/jpsreport</title>

        <link href="../../css/bootstrap-3.0.3.min.css" rel="stylesheet">
        <link href="../../css/font-awesome-4.0.3.css" rel="stylesheet">
        <link rel="stylesheet" href="../../css/highlight.css">
        <link href="../../css/base.css" rel="stylesheet">

        <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
        <!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
            <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->

        
    </head>

    <body>

        <div class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">

        <!-- Collapsed navigation -->
        <div class="navbar-header">
            <!-- Expander button -->
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>

            <!-- Main title -->
            <a class="navbar-brand" href="../..">JuPedSim/jpsreport</a>
        </div>

        <!-- Expanded navigation -->
        <div class="navbar-collapse collapse">
            <!-- Main navigation -->
            <ul class="nav navbar-nav">
            
            
                <li >
                    <a href="../..">Home</a>
                </li>
            
            
            
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">User guide <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    
                        <li >
                            <a href="../../user_guide/quickstart/">Quickstart</a>
                        </li>
                    
                        <li >
                            <a href="../../user_guide/requirements/">Requirements</a>
                        </li>
                    
                        <li >
                            <a href="../../user_guide/configuration/">Configuration</a>
                        </li>
                    
                        <li >
                            <a href="../../about/disclaimer/">Disclaimer</a>
                        </li>
                    
                        <li >
                            <a href="../../about/LICENSE/">License</a>
                        </li>
                    
                    </ul>
                </li>
            
            
            
                <li class="dropdown active">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">Input Files <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    
                        <li class="active">
                            <a href="./">Geometry File</a>
                        </li>
                    
                        <li >
                            <a href="../trajectory/">Trajectory File</a>
                        </li>
                    
                        <li >
                            <a href="../inifile/">Configuration File</a>
                        </li>
                    
                    </ul>
                </li>
            
            
            
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">Measurement methods <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    
                        <li >
                            <a href="../../methods/method_A/">Method A</a>
                        </li>
                    
                        <li >
                            <a href="../../methods/method_B/">Method B</a>
                        </li>
                    
                        <li >
                            <a href="../../methods/method_C/">Method C</a>
                        </li>
                    
                        <li >
                            <a href="../../methods/method_D/">Method D</a>
                        </li>
                    
                    </ul>
                </li>
            
            
            
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">Sample cases <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    
                        <li >
                            <a href="../../samples/get_fundamental_diagram/">How to get fundamental diagram</a>
                        </li>
                    
                        <li >
                            <a href="../../samples/get_profile/">How to get profiles</a>
                        </li>
                    
                    </ul>
                </li>
            
            
            
                <li >
                    <a href="../../contributing/">Contributing</a>
                </li>
            
            
            </ul>

            <!-- Search, Navigation and Repo links -->
            <ul class="nav navbar-nav navbar-right">
                <li >
                    <a rel="next" href="../../about/LICENSE/">
                        <i class="fa fa-arrow-left"></i> Previous
                    </a>
                </li>
                <li >
                    <a rel="prev" href="../trajectory/">
                        Next <i class="fa fa-arrow-right"></i>
                    </a>
                </li>
                
                <li>
                    <a href="https://github.com/JuPedSim/jpsreport">
                        
                            <i class="fa fa-github"></i>
                        
                        GitHub
                    </a>
                </li>
                
            </ul>
        </div>
    </div>
</div>

        <div class="container">
            <div class="col-md-3"><div class="bs-sidebar hidden-print affix well" role="complementary">
    <ul class="nav bs-sidenav">
    
        <li class="main active"><a href="#geometry">Geometry</a></li>
        
            <li><a href="#rooms">Rooms</a></li>
        
            <li><a href="#subrooms">Subrooms</a></li>
        
            <li><a href="#obstacles">Obstacles</a></li>
        
            <li><a href="#transitions">Transitions</a></li>
        
            <li><a href="#crossings">Crossings</a></li>
        
    
    </ul>
</div></div>
            <div class="col-md-9" role="main">

<h2 id="geometry"><a class="toclink" href="#geometry">Geometry</a></h2>
<p>In <code>JPSreport</code> geometry file use the same format and definitions as in <code>JPScore</code>. </p>
<p>The main structure of the geometry file is as follows </p>
<p><img alt="jpsgeometry" src="../img/geometry_classes.png" /></p>
<hr />
<p>Following picture shows a sample geometry with one room, two subrooms and one obstacle.</p>
<p><img alt="corner" src="../img/Subrooms.png" /></p>
<p><code>subrooms</code> and <code>rooms</code> are two different concepts to organize a geometry. 
Basically, it is up to the user to organize its geometry &ldquo;roomwise&rdquo; or &ldquo;subroomwise&rdquo;.</p>
<p>For instance the above mentioned geometry could also be organized using two rooms as follows:
<img alt="rooms" src="../img/Rooms.png" /></p>
<hr />
<p>A geometry can be produces manually (for small scenarios) or with <a href="https://cst.version.fz-juelich.de/jupedsim/jpseditor">jpseditor</a>.
In both cases it is recommended to visualize the geometry once finishedwith <a href="https://cst.version.fz-juelich.de/jupedsim/jpsvis">jpsvis</a>.</p>
<p>The main components of a geometry are: </p>
<ul>
<li><a href="#rooms">Rooms</a></li>
<li><a href="#subrooms">Subrooms</a></li>
<li><a href="#obstacles">Obstacles</a></li>
<li><a href="#transitions">Transitions</a></li>
<li><a href="#crossings">Crossings</a></li>
</ul>
<h3 id="rooms"><a class="toclink" href="#rooms">Rooms</a></h3>
<p>The geometry contains at least one room and one transition. 
Each room has a unique <code>id</code>, an optional caption and at least one <code>subroom</code>. 
Two rooms are separated by either walls or transitions.</p>
<pre><code class="xml">&lt;rooms&gt;
    &lt;room id=&quot;0&quot; caption=&quot;hall&quot; &gt;
&lt;/rooms&gt;
</code></pre>

<h3 id="subrooms"><a class="toclink" href="#subrooms">Subrooms</a></h3>
<p>Subrooms define the navigation mesh, i.e the walkable areas in the geometry. 
Each <code>subroom</code> is bounded by at least one <code>crossing</code>. 
Here a sample:</p>
<pre><code class="xml">&lt;subroom id=&quot;1&quot; class=&quot;stair&quot; A_x=&quot;−1.2&quot; B_y=&quot;0&quot; C=&quot;0&quot;&gt; 
    &lt;polygon caption=&quot;wall&quot;&gt;
        &lt;vertex px=&quot;0.0&quot; py=&quot;1.0&quot;/&gt;
        &lt;vertex px=&quot;−5.0&quot; py=&quot;1.0&quot;/&gt; 
    &lt;/ polygon&gt;
    &lt;polygon caption=&quot;wall&quot;&gt;
        &lt;vertex px=&quot;0.0&quot; py=&quot;3.0&quot;/&gt; 
        &lt;vertex px=&quot;−5.0&quot; py=&quot;3.0&quot;/&gt;
        &lt;/ polygon&gt;
    &lt;up px=&quot;−5.0&quot; py=&quot;2&quot;/&gt; 
    &lt;down px=&quot;0.0&quot; py=&quot;2&quot;/&gt;
&lt;/subroom&gt;
</code></pre>

<ul>
<li><code>id</code> mandatory parameter, also referred by crossings and transitions.     </li>
<li><code>class</code> optional parameter defining the type of the subroom. At the moment two classes are defined:</li>
<li><code>floor</code></li>
<li><code>stairs</code> take additionally
    <code>&lt;up px="-5.0" py="2" /&gt;</code> and   <code>&lt;down px="0.0" py="2" /&gt;</code>, which are 
    used for visualisation purposes.</li>
<li>
<p>
<script type="math/tex">A\_x,\; B\_y,\rm{and}\; C</script> are optional parameter for the explicit plane equation of the subroom,
   for the construction of a 3D environment and should be used to describe stairs. <br />
   The plane equation is given by:  <script type="math/tex">Z = Ax +By + C</script>. 
   For instance, if the stair goes through the following points: <script type="math/tex">P_1(1,0,0),\; P_2 (0,1,0)\; \rm{and}\; P_3(0,0,1)</script> 
   then the equation is given by: <script type="math/tex">Z= -x -y +1</script>.</p>
</li>
<li>
<p><code>polygon</code> describes the walls as a sequence of vertexes.</p>
</li>
</ul>
<p>To ease navigation, it is recommended to always use convex subrooms. 
In the case the subroom is not convex, additional navigation lines might be required
or the floor field router should be used. </p>
<hr />
<p><strong>Note</strong>: Every <code>room</code> has at least one <code>subroom</code>.</p>
<hr />
<h3 id="obstacles"><a class="toclink" href="#obstacles">Obstacles</a></h3>
<p>One or more obstacles can also be defined within a <code>subroom</code>. </p>
<hr />
<p><strong>Note</strong>: Obstacles should not intersect with other geometry elements e.g. walls, crossings or transitions.</p>
<hr />
<p>Sample obstacle in a subroom</p>
<pre><code class="xml">&lt;obstacle id=&quot;0&quot; caption=&quot;table&quot; height=&quot;1.0&quot; &gt;
    &lt;polygon&gt;
        &lt;vertex px=&quot;12.0&quot; py=&quot;6.0&quot;/&gt;
        &lt;vertex px=&quot;13.0&quot; py=&quot;6.0&quot;/&gt;
        &lt;vertex px=&quot;13.0&quot; py=&quot;5.5&quot;/&gt;
        &lt;vertex px=&quot;12.0&quot; py=&quot;5.5&quot;/&gt;
        &lt;vertex px=&quot;12.0&quot; py=&quot;6.0&quot;/&gt;
    &lt;/polygon&gt;
&lt;/obstacle&gt;
</code></pre>

<ul>
<li><code>id</code>, mandatory unique identifier for this obstacle.</li>
<li><code>caption</code>, used in the visualisation.</li>
<li><code>height</code>, optional parameter, not used at the moment</li>
<li><code>polygon</code>, describing the obstacle as a sequence of vertex.</li>
</ul>
<h3 id="transitions"><a class="toclink" href="#transitions">Transitions</a></h3>
<p>A <code>transition</code> defines the connection between two rooms and is basically a door.
It can be close or open (see <a href="#traffic-constraints">&ldquo;traffic constraints&rdquo;</a>).</p>
<p>An example transition between two rooms </p>
<pre><code class="xml">&lt;!-- exits between rooms or to outside (room with index = -1) --&gt;
&lt;transition id=&quot;1&quot; caption=&quot;main exit&quot; type=&quot;emergency&quot;
room1_id=&quot;0&quot; subroom1_id=&quot;1&quot; room2_id=&quot;-1&quot; subroom2_id=&quot;-1&quot;&gt;
    &lt;vertex px=&quot;15.0&quot; py=&quot;-5.0&quot;/&gt;
    &lt;vertex px=&quot;17.0&quot; py=&quot;-5.0&quot;/&gt;
&lt;/transition&gt;
</code></pre>

<ul>
<li><code>id</code>, mandatory unique identifier.
  The <code>id</code> is also used to close or open the door in the <a href="#traffic-constraints">&ldquo;traffic constraints&rdquo;</a> section of the inifile.</li>
<li><code>caption</code>, optional, used in the visualisation.</li>
<li><code>type</code>, optional. </li>
<li><code>room1_id</code>, the first room sharing this transition. The order is not important.</li>
<li><code>subroom1_id</code>, the first <code>subroom</code> located in <code>room_1</code>.</li>
<li><code>room2_id</code>, the second room sharing this transition. 
  The order is not important. 
  If there is no second room (meaning this transition is connected to the outside), then use <code>-1</code>.</li>
<li><code>subroom2_id</code>, the second <code>subroom</code> sharing this transition. The order is not important. 
  If there is no second <code>subroom</code> (meaning this transition is connected to the outside), then use <code>-1</code>.</li>
<li><code>vertex</code>: define two ending points of the <code>transition</code>.  </li>
</ul>
<h3 id="crossings"><a class="toclink" href="#crossings">Crossings</a></h3>
<p>A <code>crossing</code> defines the connection between two subrooms inside the same room. 
Unlike <code>transition</code>, they are always open.</p>
<p>A sample <code>crossing</code> between two subrooms</p>
<pre><code class="xml">&lt;!-- virtual exits between subrooms --&gt;
&lt;crossing id=&quot;0&quot; subroom1_id=&quot;0&quot; subroom2_id=&quot;1&quot;&gt;
    &lt;vertex px=&quot;10.0&quot; py=&quot;6.0&quot;/&gt;
    &lt;vertex px=&quot;10.0&quot; py=&quot;4.0&quot;/&gt;
&lt;/crossing&gt;
</code></pre>

<ul>
<li><code>id</code>, mandatory unique identifier for this <code>crossing</code>. </li>
<li><code>subroom1_id</code>, the first <code>subroom</code></li>
<li><code>subroom2_id</code>,  the second <code>subroom</code> sharing this transition. The order is not important. 
  If there is no second subroom (meaning this transition is connected to the outside), 
  then use <code>-1</code>.</li>
<li><code>vertex</code>: define two ending points of the <code>crossing</code>.</li>
</ul></div>
        </div>

	<footer class="col-md-12">
		<hr>
		
		<p>Copyright &copy; 2016 <a href="http://www.fz-juelich.de">Forschungszentrum Jülich GmbH</a>. Maintenance by <a href="http://www.fz-juelich.de/SharedDocs/Personen/IAS/JSC/EN/staff/zhang_ju.html/">Jun Zhang</a>.</p>
		
		<p>Documentation built with <a href="http://www.mkdocs.org/">MkDocs</a>.</p>
	</footer>


        <script src="../../js/jquery-1.10.2.min.js"></script>
        <script src="../../js/bootstrap-3.0.3.min.js"></script>
        <script src="../../js/highlight.pack.js"></script>
        <script src="../../js/base.js"></script>
        <script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    </body>
</html>